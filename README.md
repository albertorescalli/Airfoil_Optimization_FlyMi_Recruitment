# **Airfoil Optimization - FlyMi Recruitment**


## **Description**

This project is an airfoil optimization tool developed specifically for the FlyMi recruitment process. **The program** leverages _XFoil_ to simulate different airfoil configurations, optimizing key aerodynamic parameters like lift coefficient (CL), drag coefficient (CD), and the lift-to-drag ratio (L/D) at various angles of attack. The tool **automates simulations and performs a Pareto front analysis to identify the optimal configuration for cruise efficiency and maximum CL**.


## **Installation**

### 1. Requirements  
No external libraries or programs are required.  

### 2. Compiling  
To compile the program, use the following command:  
```
g++ -o airfoil_optimization Source\main.cpp Source\format_airfoil.cpp Source\config_settings.cpp Source\control_xfoil.cpp Source\load_airfoil.cpp Source\simulate_airfoil.cpp Source\store_sim_results.cpp Source\build_pareto_front.cpp Source\find_optimal_config.cpp Source\generate_output.cpp
```


## **Usage**

### 1. Input  
 
The program takes as input an airfoil coordinates file in **.dat** format, which should be placed in the ```Input``` folder (containing some demo files downloaded from the [UIUC Airfoil Data Site](https://m-selig.ae.illinois.edu/ads/coord_database.html)). It then reads these coordinates and sets up the airfoil geometry in _XFoil_.

### 2. Execution  
During execution, the user is prompted to specify simulation parameters, including chord, cruise speed and kinematic viscosity. The program then runs the _XFoil_ simulations based on the provided parameters, stores the data generated by _XFoil_, and finally find the optimal configuration by creating a Pareto front, trying to maximize both CL and L/D at the same time.

### 3. Output  
The results of the simulations are stored in the ```Output``` folder as _**sim_results.dat**_ and _**optimization_recap.txt**_.

### 4. Simulation Follow-Up  
At the end of each simulation, the user gets prompted to choose one of the following options: closing the program, repeating the simulation (eventually changing parameters values) or loading a different airfoil.


## **File Structure**

```header/```: Contains header files for function and global variable declarations:  
>|__ _config_settings.h_  
|__ _control_xfoil.h_  
|__ _format_airfoil.h_  
|__ _load_airfoil.h_  
|__ _simulate_airfoil.h_  
|__ _store_sim_results.h_  
|__ _build_pareto_front.h_  
|__ _find_optimal_config.h_  
|__ _generate_output.h_

```source/```: Contains the source files implementing the main logic:  
>|__ _main.cpp_: Entry point of the program.  
|__ _format_airfoil.cpp_: Handles formatting of airfoil coordinate data.  
|__ _config_settings.cpp_: Manages simulation settings and parameters.  
|__ _control_xfoil.cpp_: Interfaces with XFoil to run simulations.  
|__ _load_airfoil.cpp_: Loads airfoil data from input files.  
|__ _simulate_airfoil.cpp_: Runs airfoil simulations based on specified parameters.  
|__ _store_sim_results.cpp_: Stores results of the simulations.  
|__ _build_pareto_front.cpp_: Performs Pareto front analysis on the simulation data.  
|__ _find_optimal_config.cpp_: Identifies the optimal configuration for cruise efficiency.  
|__ _generate_output.cpp_: Generates the output file, summarizing the simulation results.  

```input/```: Contains the airfoil coordinate files used in the simulations.

```output/```: Stores the results of the simulations:  
>|__ _sim_results.dat_: Contains raw simulation data for each run.  
|__ _optimization_recap.txt_: Contains a summary of the optimal configuration found, including the best AOA and associated aerodynamic parameters.  

```airfoil_optimization.exe```: Program launcher.

```xfoil.exe```: Program used to run the airfoil simulations.


## **Program Workflow**

### 1. Airfoil Loading  
The program begins by reading the airfoil coordinates from the input file located in the ```Input``` folder. The airfoil is formatted and validated for simulation following _XFoil_ requirements:  
* **First line** contains the name of the airfoil  
* Each of the **following lines** contains a pair of coordinates separated by a single space (X Y). The coordinates are ordered starting from the trailing edge, moving toward the leading edge along the upper surface, and then back toward the trailing edge along the lower surface.

**NOTE**: _The program assumes that the original airfoil file, even if not properly formatted, still meets the following requirements: the upper surface points (whether ordered or not) are at the top, and the lower surface points (already ordered) are at the bottom._

### 2. Configuration Setup  
The values of simulation parameters can be found and manually changed in the file _**config_settings.cpp**_, located inside the ```Source``` folder.  
Initally, they are set to the following default values:  
* **Panel nodes**: 160  
(Default _XFoil_ value)  
* **Iteration limit**: 100  
(Increased from the _XFoil_ default value of 10 to prevent too many convergence failures)  
* **Starting AOA**: 0.0°  
* **Ending AOA**: 10.0°  
* **AOA Increment**: +0.5°  

Additionally, during program execution, the user can specify various parameters such as the vehicle's chord and cruise speed, and the fluid's kinematic viscosity.  
Initially, they are set to the following default values:  
* **Chord**: 0.2334 m  
(Nyx's chord has been used to set a realistic default value)  
* **Cruise speed**: 15.5 m/s (≈ 30 kts)  
(25% lower than the IMECHE's KTAS limit for the 2025 fly-off Event)  
* **Kinematic viscosity**: 1.5e-5 m<sup>2</sup>/s  
(Air's kinematic viscosity @ 1 atm, 20°C)

**These** settings **are** first **used to calculate the Reynolds number**, then configured in the program and passed to _XFoil_.

### 3. XFoil Simulations
The program interacts with _XFoil_ to run simulations for the specified range of AOAs. For each angle, the program reads CL, CD, and L/D.

### 4. Storing Results
Raw simulation results are stored in _**sim_results.dat**_, which is overwritten every time a new simulation is performed.

### 5. Pareto Front Analysis
The program performs a Pareto front analysis using airfoil simulation data to identify trade-offs between different aerodynamic parameters, helping to determine the optimal airfoil performance at a specified cruise speed. **The Pareto front represents the set of points where no other point offers both a higher lift coefficient** (CL) **and better efficiency** (L/D).

* The ```buildParetoFront``` function processes the lift (CL), drag (CD), and AOA (alpha) values obtained from _XFoil_ simulations. It compares each **point** to others in the dataset to determine whether it **is Pareto optimal, meaning no subsequent point provides a better trade-off between lift and efficiency**.

* Points with invalid lift or drag values (i.e., both equal to zero) are ignored, and if a point is dominated by another in both lift and efficiency, it is excluded from the Pareto front. The resulting Pareto front is stored in a global vector of pairs (CL, efficiency).

* Subsequently, the ```findOptimalConfig``` function identifies the optimal configuration for an airfoil based on the Pareto front calculated from the simulation results. It **selects the first point from the Pareto front as the optimal solution**, **as** this point is the first dominant value, meaning **it is the initial point in the dataset against which all subsequent points have lower values in at least one of the parameters: lift coefficient** (CL) **or efficiency** (L/D). The function then retrieves the corresponding AOA along with its lift, drag, and efficiency values that maximize the trade-off between these parameters. Finally, the results are displayed to the user.

* If no points are found in the Pareto front or if the matching values cannot be located in the simulation data, an error message is printed, and the program exits.

### 6. Output Generation
The optimization's results are summarized and written to the file _**optimization_recap.txt**_, located in the ```Output``` folder.  
**NOTE**: It is important to **move this file to a safe location**, as further simulation will otherwise overwrite its content.


## **Improvements and Additional Features**

### 1. Error Handling  
Currently, the program handles compromising errors by printing an error message and terminating program execution. An improvement would be to **implement more sophisticated error handling mechanisms that allow the user to correct them and retry simulations without restarting the entire program**. For example, if convergence fails for every AOA, the program could prompt the user to reset the simulation parameters.

### 2. Graphical Output  
Although the current implementation focuses on maximizing portability and performance, an additional feature could involve **generating graphs for key parameters**, such as:  
* CL vs. AOA  
* CD vs. AOA  
* L/D vs. AOA  
* CL vs. CD  
* Pareto Curve  

At present, this feature has not been implemented to avoid requiring additional libraries like Python (matplotlib) or Boost, ensuring that the program remains lightweight and easily portable across different systems.

### 3. Parametric Simulations for Chord Length  
Another useful feature would be the **ability to automatically run simulations for a range of chord lengths around the user-specified value**. This would provide more comprehensive data on how chord length affects the airfoil’s aerodynamic performance, giving users additional insights into optimal configurations.


## Author

_Alberto Rescalli_